<!doctype html><html lang="el"><head>
<meta charset="utf-8"><meta name="viewport" content="width=device-width, initial-scale=1">
<title>Πίνακας Ελέγχου · Γραμματέας</title>
<link rel="stylesheet" href="/css/style.css">
<script defer src="/js/api.js"></script>
<script defer src="/js/secretary.js"></script>
</head><body>
<div class="navbar">
  <button class="btn ghost" onclick="document.body.classList.toggle('nav-open')">☰ Μενού</button>
  <div class="brand"><span class="badge">AF</span> Μηχανοουργείο AutoFix</div>
  <div style="display:flex;gap:10px;align-items:center">
    <button class="btn ghost" onclick="logout()">Αποσύνδεση</button>
  </div>
</div>
<div class="sidebar">
  <a href="#dash" class="active">Πίνακας Ελέγχου</a>
  <a href="#profile">Προφίλ</a>
  <a href="#users">Χρήστες</a>
  <a href="#vehicles">Οχήματα</a>
  <a href="#appts">Ραντεβού</a>
</div>
<div class="main container">
  <section id="section-dash">
    <h2>Πίνακας Ελέγχου</h2>
    <div class="grid cols-4">
      <div class="card kpi"><div class="badge">👤</div><div><div class="small">Σύνολο Χρηστών</div><div class="num" id="kpiUsers">–</div></div></div>
      <div class="card kpi"><div class="badge">🚗</div><div><div class="small">Σύνολο Οχημάτων</div><div class="num" id="kpiVeh">–</div></div></div>
      <div class="card kpi"><div class="badge">📅</div><div><div class="small">Σύνολο Ραντεβού</div><div class="num" id="kpiAp">–</div></div></div>
      <div class="card kpi"><div class="badge">⏱️</div><div><div class="small">Σημερινά Ραντεβού</div><div class="num" id="kpiToday">–</div></div></div>
    </div>
    <div class="card" style="margin-top:18px">
      <h3>Recent Appointments</h3>
      <div id="recentAppts"></div>
    </div>

    <div class="card" style="margin-top:18px">
      <h3>Quick Actions</h3>
      <div style="display:flex;gap:12px;flex-wrap:wrap;margin-top:10px">
        <button class="btn" onclick="location.hash='#users'">👥 Manage Users</button>
        <button class="btn" onclick="location.hash='#vehicles'">🚗 Manage Vehicles</button>
        <button class="btn" onclick="location.hash='#appts'">📅 Manage Appointments</button>
      </div>
    </div>
  </section>

  <section id="section-profile" class="hidden">
    <h2>Προφίλ</h2>
    <div class="card"><div id="profileBox">Φόρτωση...</div></div>
  </section>

  <section id="section-users" class="hidden">
    <h2>Διαχείριση Χρηστών</h2>
    <div class="form-row">
      <input class="input" id="userQ" placeholder="Αναζήτηση (επώνυμο/username/ΑΦΜ)...">
      <select class="input" id="userRole"><option value="">All Roles</option><option value="customer">Πελάτης</option><option value="mechanic">Μηχανικός</option><option value="secretary">Γραμματέας</option></select>
      <button class="btn" onclick="loadUsers()">Αναζήτηση</button>
      <button class="btn secondary" onclick="promptAddUser()">+ Προσθήκη Χρήστη</button>
    </div>
    <div id="usersList" style="margin-top:10px"></div>
  </section>

  <section id="section-vehicles" class="hidden">
    <h2>Διαχείριση Οχημάτων</h2>
    <div class="form-row">
      <input class="input" id="vehQ" placeholder="Αναζήτηση οχήματος (brand/model/serial)...">
      <select class="input" id="vehType"><option value="">All Types</option><option value="passenger">Passenger</option><option value="truck">Truck</option><option value="bus">Bus</option></select>
      <button class="btn" onclick="loadVehicles()">Αναζήτηση</button>
      <button class="btn secondary" onclick="openAddVehicle()">+ Προσθήκη Οχήματος</button>
    </div>
    <div id="vehiclesList" style="margin-top:10px"></div>
  </section>

  <section id="section-appts" class="hidden">
    <h2>Διαχείριση Ραντεβού</h2>
    <div class="form-row">
      <input class="input" type="date" id="fFrom">
      <input class="input" type="date" id="fTo">
      <select class="input" id="fStatus"><option value="">All Status</option><option value="CREATED">Δημιουργημένο</option><option value="IN_PROGRESS">Σε εξέλιξη</option><option value="COMPLETED">Περατωμένο</option><option value="CANCELED">Ακυρωμένο</option></select>
      <input class="input" id="fQ" placeholder="Επώνυμο ή ΑΦΜ">
      <button class="btn" onclick="loadAppts()">Αναζήτηση</button>
      <button class="btn" onclick="openCreateAppt()">+ Προσθήκη Ραντεβού</button>
    </div>
    <div id="apptsList" style="margin-top:10px"></div>
  </section>
</div>

<script>
const sections = {
  '#dash':'section-dash',
  '#profile':'section-profile',
  '#users':'section-users',
  '#vehicles':'section-vehicles',
  '#appts':'section-appts',
};
function renderNav(){
  const hash = location.hash || '#dash';
  document.querySelectorAll('.sidebar a').forEach(a => a.classList.toggle('active', a.getAttribute('href')===hash));
  Object.values(sections).forEach(id => document.getElementById(id).classList.add('hidden'));
  document.getElementById(sections[hash]).classList.remove('hidden');
}
window.addEventListener('hashchange', renderNav);
window.addEventListener('load', renderNav);
async function logout(){ await api('/api/auth/logout',{method:'POST'}); location.href='/login.html'; }
</script>
</body></html>
